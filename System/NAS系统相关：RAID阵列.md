# NAS系统相关：RAID阵列

先来个传统艺能，写个表格对比一下：

| RAID级别 | 读性能 | 写性能 | 数据冗余 | 容错[硬盘](https://www.smzdm.com/fenlei/yingpan/)数 | [存储](https://www.smzdm.com/ju/s2qrjnp/)效率 | 成本 | 最小[磁盘](https://www.smzdm.com/ju/s2441lm/)数 | 存储空间 | 应用场景                                                     |
| :------: | :----: | :----: | :------: | :-------------------------------------------------: | :-------------------------------------------: | :--: | ----------------------------------------------- | -------- | ------------------------------------------------------------ |
|   JBOD   |   中   |   中   |    无    |                         无                          |                      中                       |  低  | 1                                               | n        | 适用于充分利用不同大小的硬盘，但不需要提供RAID阵列中的性能优势和数据保护的场景 |
|  RAID 0  |   高   |   高   |    无    |                          0                          |                      高                       |  低  | 2                                               | n        | 对性能要求高，数据安全性要求低的场景                         |
|  RAID 1  |  较高  |  一般  |    高    |                          1                          |                      低                       |  中  | 2                                               | 1        | 对数据安全性要求高，存储效率要求不高的场景                   |
|  RAID 5  |  较高  |  较高  |    是    |                          1                          |                      中                       |  中  | 3                                               | n - 1    | 对性能、数据安全性和存储空间利用率要求较高的场景             |
|  RAID 6  |  较高  |  一般  |    是    |                          2                          |                      中                       |  高  | 4                                               | n - 2    | 对数据安全性要求极高，可以容忍多硬盘故障的场景               |
| RAID 10  |   高   |   高   |    高    |                          1                          |                      低                       |  高  | 4                                               | n/2      | 对性能和数据安全性要求都较高的场景                           |
| RAID 50  |   高   |   高   |    是    |                          1                          |                      中                       |  高  | 6                                               | n/2 - 1  | 对性能、数据安全性和存储空间利用率要求较高，成本可接受的场景 |

读性能：RAID阵列的数据读取性能

写性能：RAID阵列的数据写入性能

数据冗余：是否提供数据冗余保护

容错硬盘数：RAID阵列能够容忍的最大硬盘故障数量

存储效率：实际可用存储空间占总硬盘容量的比例

成本：相对成本，包括硬件和维护等方面

最小磁盘数：构建该RAID级别所需的最少硬盘数量

存储空间：以1表示单盘存储空间，n个存储盘时的有效存储空间

应用场景：适用的场景和需求注：

**注：所有的RAID阵列读写性能的提升主要是阵列的顺序读写性能，并不能提升阵列的随机读写性能。**

### 镜像、条带化与数据校验

想要了解每个具体的RAID阵列，我们需要明确以下三个概念：即镜像、条带化和数据校验。

**镜像（Mirroring）：** 

镜像是一种数据保护技术，**它通过在两个或更多的硬盘上创建数据的完全副本来实现**。在RAID中，**RAID 1是典型的使用镜像技术的级别**。镜像技术的主要优点是提供了较高的数据安全性，因为当某个硬盘发生故障时，系统可以从另一个硬盘上的副本中读取数据。同时，镜像技术也能提高读取性能，因为数据可以从多个硬盘同时读取。然而，镜像技术的缺点是存储效率较低，因为每个硬盘上都存有完全相同的数据。

**条带化（Striping）：**

条带化是**一种将数据分割成多个部分并在多个硬盘上存储的技术**。在RAID中，**RAID 0是典型的使用条带化技术的级别**。条带化技术的主要优点是能提高数据读写性能，因为数据可以在多个硬盘上同时读取或写入。然而，条带化技术的缺点是不提供数据冗余保护，因此如果某个硬盘发生故障，可能会导致整个阵列中的数据丢失。

**数据校验（Parity）：** 

**数据校验是一种通过计算校验信息并将其存储在硬盘上的技术**，用于在硬盘发生故障时恢复丢失的数据。在RAID中，RAID 5和RAID 6是典型的使用数据校验技术的级别。数据校验技术的主要优点是能提供一定程度的数据冗余保护，同时保持较高的存储效率。当某个硬盘发生故障时，系统可以根据校验信息从其他硬盘上恢复丢失的数据。然而，数据校验技术对性能有一定影响，特别是在写入数据时需要计算和写入校验信息。

### JBOD

**JBOD（Just a Bunch Of Disks）**模式是一种将多个独立硬盘组合在一起的简单方法，但它们不形成RAID阵列。在JBOD模式下，每个磁盘都独立工作，因此存储空间是所有磁盘容量之和。读写性能与单个磁盘相当，而数据冗余和容错能力均不存在。JBOD模式可以用来充分利用不同大小的硬盘，但不提供RAID阵列中的性能优势和数据保护。

[![JBOD](https://am.zdmimg.com/202304/24/64468f06ef6102674.png_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_2/)JBOD

### RAID 0（条带化）

RAID 0通过将数据分割成等大小的块（条带），并在多个硬盘上进行分布，从而提高数据的读写速度。但由于RAID 0不提供数据冗余，因此在某个硬盘发生故障时，整个阵列的数据将丢失。适用于对性能要求较高，但数据安全性要求不高的场景。

简单来说，假设有n块相同的硬盘，RAID0就是把你的数据分割成n个部分，同时对多个硬盘进行读写，这样理论上RAID0的顺序读写速度就是n倍于该硬盘的理论速度。

[![RAID 0](https://am.zdmimg.com/202304/24/64468f06ec1c43612.png_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_3/)RAID 0

### RAID 1（镜像）

RAID 1将数据在两个或多个硬盘上进行完全复制。这种策略提供了较高的数据安全性，但存储效率较低，适用于对数据安全性要求较高的场景。

简单来说，假设有n块相同的硬盘，RAID1就是把你的数据在n块硬盘上同时存储一份，这样，只要你的n块硬盘有一块还完好，就可以读取到完整无误的数据。

[![RAID 1](https://am.zdmimg.com/202304/24/64468f06ef2cb1677.jpg_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_4/)RAID 1

### RAID 5（分布式奇偶校验）

RAID 5在多个硬盘上分布存储数据和奇偶校验信息。当某个硬盘发生故障时，可以通过其他硬盘上的数据和校验信息恢复丢失的数据。RAID 5在提供数据冗余的同时，也具有较好的存储效率。适用于对数据安全性和性能要求较高的场景。

**RAID 5是我们目前在家用[NAS](https://www.smzdm.com/ju/sp3qr1k/)上用到的最多的RAID阵列**，毕竟大部分品牌NAS的家用级的产品均以四盘位机型为主流。RAID 5阵列可以最大程度上帮助用户在数据安全和存储容量上做好平衡。



[![RAID 5](https://am.zdmimg.com/202304/24/64468f06ea6bd5468.png_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_5/)RAID 5

### RAID 6（双重奇偶校验）

RAID 6在RAID 5的基础上增加一层额外的奇偶校验信息，从而提高数据的安全性和容错能力。RAID 6可以应对最多两块硬盘同时发生故障的情况。适用于对数据安全性要求极高的场景。

[![RAID 6](https://am.zdmimg.com/202304/24/64468f06f0e454355.png_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_6/)RAID 6

### RAID 10（RAID 1+0，镜像+条带化）

RAID 10将RAID 1和RAID 0的优点结合起来，即在提供数据镜像冗余的同时，还能实现数据的条带化分布，从而提高性能。RAID 10适用于对性能和数据安全性要求较高的场景。

[![RAID 10](https://qnam.smzdm.com/202304/24/64468f06eac1b825.png_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_7/)RAID 10

在日常生活中，想要使用RAID10阵列也必须是四盘位起步，而且大部分NAS系统并不支持RAID10阵列，这个时候我们一般需要用到**阵列卡**来组成RAID10阵列。

这个时候聪明的值友就会产生一个问题，那是先有鸡还是先有蛋呢？即是先有RAID1还是先有RAID0阵列呢？其实从这小节题目就可以看出，组RAID 1+0阵列首先**要先有RAID1子阵列，然后再将多个子阵列组为RAID0阵列。这样RAID10阵列就诞生了**。

### RAID 50（RAID 5+0，分布式奇偶校验+条带化）

RAID 50是将多个RAID 5阵列进行条带化组合而成的。它在提供数据冗余的同时，还具有较好的性能和存储效率。适用于对数据安全性、性能和存储空间利用率要求较高的场景。

[![RAID 50](https://am.zdmimg.com/202304/24/64468f073bef25363.jpg_e1080.jpg)](https://post.smzdm.com/p/a8xqe6oq/pic_8/)RAID 50

RAID50原理和RAID10可以结合起来一起理解，这里就不再赘述了。

**了解不同RAID级别的特点和适用场景，可以帮助你根据实际需求选择合适的RAID阵列配置。在选择时，需要权衡性能、数据安全性和存储效率等因素，以实现最佳的存储解决方案。**

不过你以为这就结束了吗？那怎么可能。

## 奇奇怪怪的raid阵列增加了

尽管RAID 0、1、5、6、10和50是常见的RAID级别，但还存在一些其他的RAID级别，它们在某些特定场景下也具有一定的应用价值。以下是关于RAID 2、3、4的简要介绍：

### RAID 2（位级条带化）

RAID 2使用位级条带化将数据分割成位，并在多个硬盘上进行分布。此外，RAID 2还采用Hamming码作为纠错码，以提高数据的可靠性。然而，由于RAID 2要求硬盘之间的同步，且纠错编码计算较为复杂，因此在实际应用中较少使用。

### RAID 3（字节级条带化带奇偶校验）

RAID 3采用字节级条带化将数据分割成字节，并在多个硬盘上进行分布。与RAID 5类似，RAID 3还使用单独的硬盘来存储奇偶校验信息。然而，由于RAID 3要求硬盘之间的同步，且单独的校验硬盘可能成为性能瓶颈，因此在实际应用中较少使用。

### RAID 4（块级条带化带奇偶校验）

RAID 4采用块级条带化将数据分割成块，并在多个硬盘上进行分布。与RAID 3类似，RAID 4也使用单独的硬盘来存储奇偶校验信息。尽管RAID 4具有较好的读性能，但由于写性能受到单独校验硬盘的限制，因此在实际应用中较少使用。

当然奇奇怪怪的RAID阵列远不止这些，还有包括RAID1.5、RAIDK等。

**ZFS系统的RAIDZ和RAIDZ2等，我们会单独放在ZFS系统篇来讲。**

## 总结

今天我们重点讲了各个RAID阵列的构成和区别，通过权衡性能、数据安全性和存储效率等因素，以期帮助大家实现最佳的存储解决方案。